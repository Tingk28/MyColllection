---
title: "Programming Language: Midterm"
author: "H14086030"
output: 
  html_document:
  code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#set.seed("the last four digits of the student ID")
##########################################
Myseed <- (6030)
##########################################
# Do not change the codes below
set.seed(Myseed)
my.x2021 <- round( runif(2), 2)
my.n2021 <- sort(sample(c(50, 100, 200, 500), 2))
my.lambda2021 <- round( rpois(1, lambda = 1.5), 2)
my.p2021 <- round(runif(1), 2)
my.r <- sample(1:10, 1)
my.alpha <- round(rgamma(1,1,1), 2)
my.beta <- round(rgamma(1,1,1), 2)
##########################################
```

```{r, echo=FALSE}
print(paste("My seed is :", Myseed))
```


# Problem 0 (30%)

(a). Write a R program to get all prime numbers up to a given number (based on the sieve of Eratosthenes).  
(b). Write a R program to print the numbers from 1 to 100 and print “Fizz” for multiples of 3, print “Buzz” for multiples of 5, and print “FizzBuzz” for multiples of both.  
(c). Write a R program to create three vectors a,b,c with 3 integers. Combine the three vectors to become a 3×3 matrix where each column represents a vector. Print the content of the matrix.  
(d). Write a R program to compute sum, mean and product of a given vector elements.  
(e). Write a R program to create two 2x3 matrix and add, subtract, multiply and divide the matrices.  

```{r}
# (a)
# (b)
Fizzbuzz_1<-function(x){
  result<-c()
  for(i in x){
    if(i%%3==0&&i%%5==0){
      result<-c(result,"FizzBuzz")
    }else if(i%%3==0){
      result<-c(result,"Fizz")
    }else if(i%%5==0){
      result<-c(result,"Buzz")
    }else{
      result<-c(result,i)
    }  
  }
  return(result)
}
x <- c(1:100)
1:100
Fizzbuzz_1(x)
# (c)
a<-c(1,3,5)
b<-c(2,4,6)
c<-c(5,7,9)
temp<-c(a,b,c)
ans<-matrix(temp,nrow=3,ncol = 3)
ans
# (d)
x<-c(5,6,7,3)
sum<-0
product<-1
for(i in x){
  sum<-sum+i
  product<-product*i
}
mean<-sum/ length(x)
cat("sum=",sum)
cat("mean=",mean)
cat("product=",product)
# (e)
a<-matrix(7:12,nrow=2,ncol = 3)
b<-matrix(1:6,nrow=2,ncol = 3)
a+b
a-b
a*b
a/b
```



# Problem 1 (10%)

Calculate the sum $\sum_{k=1}^n x^k/k$, and compare with $-ln(1-x)$, for $x=`r my.x2021[1]`, `r my.x2021[2]`$ and $n=`r my.n2021[1]`, `r my.n2021[2]`$.

```{r}
#1
n<-100
x<-.61
k<-1:n
a<-(x^k)/k
suma=sum(a)
b<--1*log(base=exp(1),(1-x))
cat("n=",n,"x=",x)
cat("sigma:x^k/k=",suma,"\nlog...=",b,"\n")
#2
n<-200
x<-.61
k<-1:n
a<-(x^k)/k
suma=sum(a)
b<--1*log(base=exp(1),(1-x))
cat("n=",n,"x=",x)
cat("sigma:x^k/k=",suma,"\nlog...=",b,"\n")
#3
n<-100
x<-.71
k<-1:n
a<-(x^k)/k
suma=sum(a)
b<--1*log(base=exp(1),(1-x))
cat("n=",n,"x=",x)
cat("sigma:x^k/k=",suma,"\nlog...=",b,"\n")
#4
n<-200
x<-.71
k<-1:n
a<-(x^k)/k
suma=sum(a)
b<--1*log(base=exp(1),(1-x))
cat("n=",n,"x=",x)
cat("sigma:x^k/k=",suma,"\nlog...=",b,"\n")
```


# Problem 2 (10%)

Let $f_n$ denote the $n$th Fibonacci number.  

   (a). Construct a sequence of ratios of the form $f_n/f_{n-1}$, $n=1,...,30$. Does the sequence appear to be converging?  
   (b). Compute the golden ratio $(1+\sqrt{5})/2$. Is the sequence converging to the ratio? Please draw a graph to support your answer.  

```{r}
#(a)
N <- 30
Fibonacci <- numeric(N)
Fibonacci[1] <- 1
Fibonacci[2] <- 1
for (n in 3:N) Fibonacci[n] <- Fibonacci[n-1] + Fibonacci[n-2]
n_f<-c(1,Fibonacci[1:29])
ratio=Fibonacci/n_f
plot(ratio)
# yes,it appear to be converging
```


```{r}
#(a)
N <- 30
Fibonacci <- numeric(N)
Fibonacci[1] <- 1
Fibonacci[2] <- 1
for (n in 3:N) Fibonacci[n] <- Fibonacci[n-1] + Fibonacci[n-2]
Fibonacci#f n
n_f<-c(1,Fibonacci[1:29])
n_f#f n-1
ratio=Fibonacci/n_f
plot(ratio)
# yes,it appear to be converging
(1+sqrt(5))/2
abline(h = (1+sqrt(5))/2, lwd=2, col="red", xlab="n", ylab="Ratio")
# yes,it appear to be converging to the ratio in (a)
```

 
# Problem 3

(a). Let $X$ be a Poisson random variable with mean $\lambda=`r my.lambda2021`$. Calculate the mean and variance of $X$ using `while` loop. (8%)  
(b) Let $Y$ be a geometric random variable with parameter $p$. The probability mass function of $Y is
$$Pr\{Y=y\}=(1-p)^{x-1}p,x=1,2,...,0<p<1$$
Use `repeat` loop to calculate the mean of $Y$ with $p=`r my.p2021`$. (7%)

```{r}
#(a)
Pois_info <- function(lamba){
  k<- 0
  pois <- (exp(-1*lamba)*lamba^k)/factorial(k)
  mean<-0
  var <-0
  while(pois>10^-10||k<20){#為了避免lamba過大導致f(0)小於10^-10不符合while判斷標準導致mean=0
    mean<- mean+k*pois
    k<-k+1
    pois<- (exp(-1*lamba)*(lamba^k))/factorial(k)
  }
  k <- 0
  pois <- (exp(-1*lamba)*lamba^k)/factorial(k)
  while(pois>10^-10||k<20){
    var<- var+(k-mean)^2 *pois
    k<-k+1
    pois<- (exp(-1*lamba)*(lamba^k))/factorial(k)
  }
  return(list(mean=mean,vaiance=var))
}
Pois_info(1)
```


```{r}
#(b)

pr<-function(x,p=.76){(1-p)^(x-1)*p}
x<-1
mean<-0
repeat{
  mean<-mean+x*pr(x)
  if(pr(x)<10^-20)break
  x<-x+1
}
mean
```


# Problem 4

(a). Use a fixed-point iteration to find a root of $cox(x)-xe^x=0$. How many iteration does it take before you have an answer which is accurate in the first two digits?  (5%)  
(b). Use Newton's method to find a root of $cox(x)-xe^x=0$. How many iteration does it take before you have an answer which is accurate in the first two digits? (10%)  

```{r}
'''#(a)
it <- 3
x0 <- 0.1 # initial guess
mycos<-c(x0,cos(x0)-x0*exp(x0))
while(abs(mycos[it-1]-mycos[it])>0.005){
  mycos<-c(mycos,cos(mycos[it-1])-mycos[it-1]*exp(mycos[it-1]))
  print(it)
  it<-it+1
  
}
plot(mycos)'''

```{r}
#(b)

```


# Problem 5

Write a function that can fill the area under curve (the Exponential distribution with rate $\lambda=`r my.lambda2021`$) for a given value $x > 0$ on the x-axis. The probability density function is 
$$f(x)=\lambda e^{-\lambda x}, x>0$$
The user can specify the following options: (a) upper-tail or lower-tail  (b) the value on the x-axis. (20%)

```{r}
# Ans
'''Myplot<-function(location, upper = TRUE){
  point<-exp(-1*seq(0,10,0.05))
  
  if(upper){
    col_range<- seq(location, 3, 0.05)
    header<-paste("Pr(X>",as.character(location),"), X ~ exp(1)")
  }else if(upper==FALSE){
    col_range<- seq(-3, location, 0.1)
    header<-paste("Pr(X<",as.character(location),"), X ~ N(0, 1)")
  }
  plot(seq(0,10,0.05),point,type="l")
  #plot(total,dnorm(total,mean=0,sd=1),xlim=c(-3,3),col="black",type="l",ylab="f(x)",xlab="x",main=header)
  polygon(c(col_range,rev(col_range)),c(exp(-1*col_range)),rep(0,length(col_range))),col="green",border ="green" )
}
Myplot(location = 1, upper = TRUE)
Myplot(location = 5, upper = FALSE)
```


# Problem 6  

Suppose that we have a function
$$f(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-\mu)^2}{2}}, -\infty < x < \infty.$$
Please find the maximum of the function above using fixed-point iteration or Newton's method. (15%)

```{r}
# Ans

```

